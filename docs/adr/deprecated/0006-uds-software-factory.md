# 6. UDS Software Factory

Date: 2023-06-05

## Status

Accepted

## Context

Multiple mission heroes have asked us to deploy a "software factory" to be used by development teams to facilitate the
development, sharing, testing, deployment and accreditation of custom software. We anticipate that additional
organizations, customers, and heroes will make this request over time. As such, we intend to develop a UDS Software
Factory (SWF) package capable of providing a consumable and reusable set of capabilities to meet this need.

## Guiding Principles

* The SWF package will contain a MINIMAL set of capability for supporting core development workflows
* The SWF package will be deployed alongside, and integrated with, additional (optional) UDS packages, depending on
  the needs of a specific environment or mission
* The SWF package will prioritize FOSS tools, but be open to supporting closed source tooling as optional / addon
  packages in a given environment
* All packages will be deployed on DUBBD (UDS Core) and will leverage security tooling from that platform
* Favor capabilities and tooling already leveraged within existing Defense Unicorn tools and projects (i.e. SBOMs
  generated by Zarf)

## End State Vision

The Defense Unicorns Software Factory UDS package contains our opinionated recommendation for providing a secure,
reproducible and security compliant development environment. In order to demonstrate that compliance to potential
customers and accreditation officials, we will construct a body of evidence outlining how the provided capabilities
and configurations meet the following standards:

* [DevSecOps Refrence Design Chapter 4/5](https://dodcio.defense.gov/Portals/0/Documents/Library/DevSecOpsReferenceDesign.pdf)
* [SLSA](https://slsa.dev/spec/v0.1/levels)
* Develop a framework for expanding to other standards as the need is identified

Because some of the tools and configurations will require assumptions about what languages are being used, we will
initially plan to support the following languages, with the intention of expanding our capability on an as-needed
basis:

* Python
* Go
* Java
* Support further expansion as the need is identified

## Functionality Requirements

The Software Factory package MUST:

1. Provide developer teams secure access to a Source Configuration Management (SCM) tool
2. Provide runtime security and monitoring for the environment
3. Enable CI workflows
4. Provide security scanning capability
   1. Anti-virus
   2. Static code analysis
   3. Secret scanning
   4. Vulnerability Scanning
   5. Dependency analysis
   6. Build provenance
5. Provide the ability to store sensitive values for builds and CI
6. Require/validate adoption of security related CI steps to ensure compliance
7. Enable output and sharing of artifacts:
   1. Build artifacts such as Docker images
   2. Security documentation and reports
8. Provide role based access control to limit users' access to resources and configuration options

Additional packages MAY optionally provide:

* Identity and Access Mangement (IDAM)
* PVC backup and restore
* Collaboration tools (e.g. Chatops, task management etc)
* A storage provider (e.g. S3, minio, rook/ceph etc)

## Software Factory Capability Matrix

| Capability                             | Tool                 | UDS Package | Now / Next / Later |
|----------------------------------------|----------------------|-------------|----------------------------|
| Secure Access                          | Bigbang              | DUBBD       | Now                        |
| Runtime Security / Monitoring          | Bigbang              | DUBBD       | Now                        |
| Source Control Management (SCM) tool   | Gitlab               | SWF         | Now                        |
| CI/CD Runner(s)                        | Gitlab-Runners       | SWF         | Now                        |
| Anti-Virus                             | ClamAV               | SWF         | Next                       |
| Static Code Analysis                   | SonarQube            | SWF         | Now                        |
| Secret Scanning                        | GitLeaks             | SWF         | Next                       |
| SBOM creation                          | Zarf                 | n/a         | Next                       |
| Code Signing                           | Cosign               | SWF         | Next                       |
| Vulnerability Scanning                 | Neuvector            | SWF         | Now                        |
| Vulnerability Aggregation / Management | ??                   |             | Later                      |
| Registry                               | Gitlab               | SWF         | Now                        |
| Artifact Repository                    | Gitlab               | SWF         | Now                        |
| Secret Store                           | Gitlab               | SWF         | Now                        |
---|

By establishing opinionated recommendations for these capabilities, we believe we can provide a consumable and
reusable software factory package to provide the basic desired functionality.

## Consequences

The main consequence of this decision is that customers and mission environments may have their own pre-existing
assumptions and preferences when it comes to tooling to support these capabilities. Defining our own opinionated stack
will make it more difficult to deviate in the future. Leveraging existing capabilities over external tools (e.g.
Gitlab registry over Nexus), might lead to a form of vendor lock-in. We should safeguard against this wherever
possible be striving to support interoperability for common components and tools.
